
@{
    ViewBag.Title = "Roomlist";
    Layout = "~/Views/Shared/ContentLayout.cshtml";
}
<link href="@Url.Content("~/css/Theadscroll.css")" rel="stylesheet" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="~/js/Validation.js"></script>

@{
    var CssStyle = @"@media only screen and (max-width:760px),(min-device-width:768px) and (max-device-width:881px)
{.dytable table,.dytable tbody,.dytable td,.dytable th,.dytable thead,.dytable tr{display:block}
.dytable thead tr{position:absolute;top:-9999px;left:-9999px}.dytable tr{border:1px solid #ccc}
.dytable td{border:none;border-bottom:1px solid #eee;position:relative;padding-left:50%}
.dytable td:before{position:absolute;top:6px;left:6px;width:45%;padding-right:10px;white-space:nowrap}

.dytableroom table,.dytableroom tbody,.dytableroom td,.dytableroom th,.dytableroom thead,.dytableroom tr{display:block}
.dytableroom thead tr{position:absolute;top:-9999px;left:-9999px}.dytableroom tr{border:1px solid #ccc}
.dytableroom td{border:none;border-bottom:1px solid #eee;position:relative;padding-left:50%}
.dytableroom td:before{position:absolute;top:6px;left:6px;width:45%;padding-right:10px;white-space:nowrap}

                    .dytableroom tr td:nth-child(1){width:auto !important;}.dytableroom tr td:nth-child(2){width:auto !important;}
                    .dytableroom tr td:nth-child(3){width:auto !important;}.dytableroom tr td:nth-child(4){width:auto !important;}
                    .dytableroom tr td:nth-child(5){width:auto !important;}.dytableroom tr td:nth-child(6){width:auto !important;}
                    .dytableroom tr td:nth-child(7){width:auto !important;}.dytableroom tr td:nth-child(8){width:auto !important;}
                    .dytableroom tr td:nth-child(9){width:auto !important;}.dytableroom tr td:nth-child(10){width:auto !important;}
                    .dytableroom tr td:nth-child(10){width:auto !important;}

                    .dytableroom tr td:nth-of-type(1):before{content:'Meeting Code';font-weight: bold;}
                    .dytableroom tr td:nth-of-type(2):before{content:'Session';font-weight: bold;}
                    .dytableroom tr td:nth-of-type(3):before{content:'First Name';font-weight: bold;}
                    .dytableroom tr td:nth-of-type(4):before{content:'Last Name';font-weight: bold;}
                    .dytableroom tr td:nth-of-type(5):before{content:'Email';font-weight: bold;}
                    .dytableroom tr td:nth-of-type(6):before{content:'Arrive Date';font-weight: bold;}
                    .dytableroom tr td:nth-of-type(7):before{content:'Depart Date';font-weight: bold;}
                    .dytableroom tr td:nth-of-type(8):before{content:'No.of Nights';font-weight: bold;}
                    .dytableroom tr td:nth-of-type(9):before{content:'Room Type';font-weight: bold;}
                    .dytableroom tr td:nth-of-type(10):before{content:'Roommate';font-weight: bold;}
                    .dytableroom tr td:nth-of-type(11):before{content:'Room No.';font-weight: bold;}

                    .dytable tr td:nth-child(1){width:auto !important;}.dytable tr td:nth-child(2){width:auto !important;}
                    .dytable tr td:nth-child(3){width:auto !important;}.dytable tr td:nth-child(4){width:auto !important;}
                    .dytable tr td:nth-child(5){width:auto !important;}.dytable tr td:nth-child(6){width:auto !important;}
                    .dytable tr td:nth-child(7){width:auto !important;}.dytable tr td:nth-child(8){width:auto !important;}
                    .dytable tr td:nth-child(9){width:auto !important;}.dytable tr td:nth-child(10){width:auto !important;}
                    .dytable tr td:nth-child(11){width:auto !important;}.dytable tr td:nth-child(12){width:auto !important;}

                    .dytable tr td:nth-of-type(1):before{content:'Type';font-weight: bold;}
                    .dytable tr td:nth-of-type(2):before{content:'Company';font-weight: bold;}
                    .dytable tr td:nth-of-type(3):before{content:'First Name';font-weight: bold;}
                    .dytable tr td:nth-of-type(4):before{content:'Last Name';font-weight: bold;}
                    .dytable tr td:nth-of-type(5):before{content:'Title';font-weight: bold;}
                    .dytable tr td:nth-of-type(6):before{content:'Roommate';font-weight: bold;}
                    .dytable tr td:nth-of-type(7):before{content:'Room Type';font-weight: bold;}
                    .dytable tr td:nth-of-type(8):before{content:'Room No';font-weight: bold;}
                    .dytable tr td:nth-of-type(9):before{content:'Arrive Date';font-weight: bold;}
                    .dytable tr td:nth-of-type(10):before{content:'Depart Date';font-weight: bold;}
                    .dytable tr td:nth-of-type(11):before{content:'No.of Nights';font-weight: bold;}
                    .dytable tr td:nth-of-type(12):before{content:'Sesssion';font-weight: bold;}

                    .dytable1 tr td:nth-of-type(1):before{content:'Total';font-weight: bold;}
                    .dytable1 tr td:nth-of-type(2):before{content:'Day1';font-weight: bold;}
                    .dytable1 tr td:nth-of-type(3):before{content:'Day2';font-weight: bold;}
                    .dytable1 tr td:nth-of-type(4):before{content:'Day3';font-weight: bold;}
                    .dytable1 tr td:nth-of-type(5):before{content:'Day4';font-weight: bold;}
                    .dytable1 tr td:nth-of-type(6):before{content:'Day5 Mate';font-weight: bold;}
                    .dytable1 tr td:nth-of-type(7):before{content:'Day6';font-weight: bold;}
                    .dytable1 tr td:nth-of-type(8):before{content:'Day7';font-weight: bold;}

                  @media only screen and (min-device-width :320px) and (max-device-width :480px){body{padding:0;margin:0;width:100%}}@media only screen and (min-device-width:768px) and (max-device-width:1024px){body{width:100%}}";
}

<style type="text/css">
        @Html.Raw(CssStyle)
</style>

<style type="text/css">
    .ui-datepicker-year {
        width: 80px !important;
    }

    .ui-datepicker-month {
        width: 70px !important;
    }

    #ui-datepicker-div {
        z-index: 2000 !important;
        width: 253px;
    }

    .textbox_size {
        width: 30%;
    }
</style>
<style>
    /** {box-sizing: border-box}
    body {font-family: "Lato", sans-serif;}*/

    /* Style the tab */
    div.tab {
        float: left;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
        width: 10%;
        height: 90%;
    }

        /* Style the buttons inside the tab */
        div.tab button {
            display: block;
            /*background-color: inherit;*/
            /*background:  #000020;*/
            background: #142e54;
            color: white;
            padding: 10px 14px;
            width: 100%;
            border: none;
            outline: none;
            text-align: left;
            cursor: pointer;
            transition: 0.3s;
            font-size: 13px;
            font-weight: bold;
            line-height: 15px;
        }

            /* Change background color of buttons on hover */
            div.tab button:hover {
                /*background-color: #0079C1 ;*/
                color: #2A2;
            }

            /* Create an active/current "tab button" class */
            div.tab button.active {
                /*background-color: #ccc;*/
                color: #2A2;
            }

    /* Style the tab content */
    .tabcontent {
        float: left;
        padding: 0px 12px;
        /*border: 1px solid #ccc;*/
        width: 85%;
        /*border-left: none;*/
        height: 98%;
    }


    /*SPP*/
    #btnSppSave:hover, #btnSppSave:active, #btnSppSave:focus, .btn-group.open #btnSppSave.dropdown-toggle {
        background: #149216;
    }

    #btnSppSave, #btnSppSave:link {
        background: #149216;
        border-color: #daa004;
    }

    .ui-datepicker-calendar thead, tbody {
        overflow-y: overlay !important;
        width: 100% !important;
    }
</style>

<script type="text/javascript">
    var search;
    var rowIndex = 0;
    var sysdate = "";
    var mtgno = "", startdate = "", MeetId = "";
    var menuName = 'Room List', submenuname = "";
    $(document).ready(function () {
        roomlist = new viewModel();
        search = roomlist;

        $("#Arrive").datepicker();
        $("#Depart").datepicker({ dateFormat: 'mm/dd/yy', changeMonth: true, changeYear: true });


        ko.applyBindings(roomlist);

        $("#btnAdd").click({ handler: roomlist.Add });
        $("#btnEdit").click({ handler: roomlist.Edit });
        $("#btnSave").click({ handler: roomlist.Save });
        $("#btnDelete").click({ handler: roomlist.Delete });
        $("#btnCancel").click({ handler: roomlist.Cancel });
        $("#Arrive").change({ handler: roomlist.arrivedatechange });
        $("#Depart").change({ handler: roomlist.Calculatenight });
        $("#cmbcontact").change({ handler: roomlist.contactchange });

        $("#cmbsession").change({ handler: roomlist.summarycombochange });
        $("#cmbtype").change({ handler: roomlist.summarycombochange });
        
        // var Header = '@ViewBag.Header';
        NO = '@ViewBag.No';
        screenname = '@ViewBag.ScreenName';
        companyname = window.parent.document.getElementById('company').value;
        NoteHeadTitle = screenname + " Room List For: " + NO + " - " + companyname;
        //self.NoteTitle(NoteHeadTitle);

        $("#Title").text(NoteHeadTitle);


        $("#MainNotesDialog").dialog({
            draggable: false,
            autoOpen: false,
            autoresize: false,
            modal: true,
            dragable: false
        });

      

        //For IE
        var isIE = !!navigator.userAgent.match(/Trident/g) || !!navigator.userAgent.match(/MSIE/g);
        if (isIE) {
            $('table#tblsummary1').css("overflow-x", "hidden");
            $('table#tblsummary1').css("overflow-y", "hidden");
            $('table#tblsummary1 tbody').css("overflow-y", "scroll");
            $('table#tblsummary1 tbody').css("height", "400px");
            $('table#tblsummary1 thead').css("width", "98.5%");

            $('table#tblroom').css("overflow-x", "hidden");
            $('table#tblroom').css("overflow-y", "hidden");
            $('table#tblroom tbody').css("overflow-y", "scroll");
            $('table#tblroom tbody').css("height", "250px");
            $('table#tblroom thead').css("width", "98.5%");
        }

    });

    function viewModel() {
        var self = this;

        self.EnableDisableMode = ko.observable(true);
        self.AddMode = ko.observable(false);
        self.EditMode = ko.observable(true);
        self.SaveMode = ko.observable(false);
        self.btnDelete = ko.observable(false);

        self.MeetingId = ko.observable();
        self.txtmtgno = ko.observable();
        self.txtcompany = ko.observable();
        self.txtmfgno = ko.observable();
        self.txtcontactno = ko.observable();
        self.cmbcontactlist = ko.observable();
        self.txtroommate = ko.observable();
        self.txtroomtype = ko.observable();
        self.txtroomno = ko.observable();
        self.txtnights = ko.observable();
        self.txtarrive = ko.observable();
        self.txtdepart = ko.observable();
        self.txtsharecode = ko.observable();
        self.txtContactTitle = ko.observable();
        self.txtContactEmail = ko.observable();

        self.txtsessno = ko.observable();
        self.cmbsessnolist = ko.observable();
        self.cmbsharinglist = ko.observable();

        self.cmbroomtypelist = ko.observable();

        self.txtconfno = ko.observable();
        self.txtremarks = ko.observable();
        self.txtcode_1 = ko.observable();
        self.cmbcheckoutlist = ko.observable();

        self.FillRoomlistgridd = ko.observable();
        self.FillMeetinglistgrid = ko.observable();
        self.FillMeetinglistgrid2 = ko.observable();
        self.FillGrid = ko.observable();
        self.FillMeetingGrid = ko.observable();

        self.menulist = ko.observableArray([]);
        self.mainmenulist = ko.observableArray([]);

        self.txtsession = ko.observable();
        self.cmbsessionlist = ko.observable();
        self.txttype = ko.observable();
        self.cmbtypelist = ko.observable();

        window.parent.CallEnableTabs();

        opentab();

        $.ajax({
            url: "GetLookupList",
            data: { LukpID: "STYPE" },
            type: "POST",
            async: false,
            success: function (response) {
                self.cmbsharinglist(response.Items);
                self.cmbcheckoutlist(response.Items);
            }
        });

        $.ajax({
            url: "GetLookupList",
            data: { LukpID: "SESSION" },
            type: "POST",
            async: false,
            success: function (response) {
                self.cmbsessnolist(response.Items);
                self.cmbsessionlist(response.Items);
            }
        });
        $.ajax({
            url: "GetLookupList",
            data: { LukpID: "ROOMTYPE" },
            type: "POST",
            async: false,
            success: function (response) {
                self.cmbroomtypelist(response.Items);
            }
        });

        $.ajax({
            url: "GetCompanyType",
            type: "POST",
            async: false,
            success: function (response) {
                self.cmbtypelist(response.Items);
            }
        });


        $(".clickableRow").live("click", function () {
            if (self.SaveMode() == true && self.AddMode() == true) {
                //$(this).removeClass('success');
                $('.clickableRow').removeClass('success selected');
                return false;
            }
            else if (self.SaveMode() == true && self.AddMode() == false) {
                $('.clickableRow').removeClass('success selected');
                $('#' + rowIndex).addClass('success selected');
            }
            else {
                rowIndex = $(this).attr("id");
                self.SelectedMfgroomlist(self.FillRoomlistgridd()[rowIndex]);
                $('.clickableRow').removeClass('selected');
                $(this).addClass('selected');
            }
        });


        $(".exportclass").live("contextmenu", function (event) {
            event.preventDefault();
            event.stopPropagation();
            $('#export').remove();
            if (event.which == 3) {
                self.menulist().length = 0;
                evecount = event.currentTarget.children;
                for (var i = 0; i < evecount.length; i++) {
                    self.menulist.push(evecount[i].innerText);
                    if (evecount[i].className == 'hide') {
                        $("#chk_" + [i]).attr('checked', false);
                    }
                    else {
                        $("#chk_" + [i]).attr('checked', true);
                    }
                }
                self.menulist();
                $("#NotesDialog").dialog("open");
                $('#ui-id-1').prepend('<img id="export" style="width:20px; height:20px;float:right" src="../images/Export.png" title="Export Data" onclick="fnExcelReport();" />');

            }

        });

        $(".main-exportclass").live("contextmenu", function (event) {
            event.preventDefault();
            event.stopPropagation();
            $('#export').remove();
            if (event.which == 3) {
                self.mainmenulist().length = 0;
                evecount = event.currentTarget.children;
                for (var i = 0; i < evecount.length; i++) {
                    self.mainmenulist.push(evecount[i].innerText);
                    if (evecount[i].className == 'hide') {
                        $("#mchk_" + [i]).attr('checked', false);
                    }
                    else {
                        $("#mchk_" + [i]).attr('checked', true);
                    }
                }
                self.mainmenulist();
                $("#MainNotesDialog").dialog("open");
                $('#ui-id-2').prepend('<img id="export" style="width:20px; height:20px;float:right" src="../images/Export.png" title="Export Data" onclick="fnExcelReport2();" />');
            }
        });

        /* checked on double table  */
        $('.main-checked').live('click', function (event) {
            if (this.checked == false) {
                var rowindex = this.id;
                rowindex = rowindex.replace("mchk_", "");
                rowindex++;
                $('.main-tablesort th').filter(':nth-child(' + rowindex + ')').removeClass('sorted sorted-asc sorted-desc');
                $('.main-tablesort td').filter(':nth-child(' + rowindex + ')').removeClass('sorted sorted-asc sorted-desc');

                $('.main-tablesort th').filter('.main-tablesort :nth-child(' + rowindex + ')').removeClass('sortable');
                $('.main-tablesort td').filter('.main-tablesort :nth-child(' + rowindex + ')').removeClass('sortable');

                $('.main-tablesort th').filter('.main-tablesort :nth-child(' + rowindex + ')').addClass('hide');
                $('.main-tablesort td').filter('.main-tablesort :nth-child(' + rowindex + ')').addClass('hide');

                $('.innertable th').filter(':nth-child(' + rowindex + ')').removeClass('hide');
                $('.innertable td').filter(' :nth-child(' + rowindex + ')').removeClass('hide');

                if ($('.main-exportclass th').length == $('.main-tablesort th.hide').length) {
                    alert("warning", "Please select atleast one column");
                    $('.main-tablesort th').filter(':nth-child(' + rowindex + ')').removeClass('sorted sorted-asc sorted-desc');
                    $('.main-tablesort td').filter(':nth-child(' + rowindex + ')').removeClass('sorted sorted-asc sorted-desc');

                    $('.main-tablesort th').filter('.main-tablesort :nth-child(' + rowindex + ')').removeClass('hide');
                    $('.main-tablesort td').filter(':nth-child(' + rowindex + ')').removeClass('hide');

                    $('.main-tablesort th').filter('.main-tablesort :nth-child(' + rowindex + ')').addClass('sortable');
                    $('.main-tablesort td').filter('.main-tablesort :nth-child(' + rowindex + ')').addClass('sortable');

                    $('.innertable th').filter(':nth-child(' + rowindex + ')').removeClass('hide');
                    $('.innertable td').filter(' :nth-child(' + rowindex + ')').removeClass('hide');

                    rowindex--;
                    $("#mchk_" + [rowindex]).attr('checked', true);
                }

            }
            else if (this.checked == true) {
                var rowindex = this.id;
                rowindex = rowindex.replace("mchk_", "");
                rowindex++;
                $('.main-tablesort th').filter(':nth-child(' + rowindex + ')').removeClass('sorted sorted-asc sorted-desc');
                $('.main-tablesort td').filter(':nth-child(' + rowindex + ')').removeClass('sorted sorted-asc sorted-desc');

                $('.main-tablesort th').filter('.main-tablesort :nth-child(' + rowindex + ')').removeClass('hide');
                $('.main-tablesort td').filter(':nth-child(' + rowindex + ')').removeClass('hide');

                $('.main-tablesort th').filter('.main-tablesort :nth-child(' + rowindex + ')').addClass('sortable');
                $('.main-tablesort td').filter('.main-tablesort :nth-child(' + rowindex + ')').addClass('sortable');

                $('.innertable th').filter(':nth-child(' + rowindex + ')').removeClass('hide');
                $('.innertable td').filter(' :nth-child(' + rowindex + ')').removeClass('hide');
            }
            else {
            }
        });


        $('.main-tablesort th').each(function (column) {
            $('.main-tablesort th').css({ "cursor": "pointer" });
            $('.main-tablesort td').css({ "cursor": "default" });
            $(this).addClass('sortable').click(function () {
                var findSortKey = function ($cell) {
                    return $cell.find('.sort-key').text().toUpperCase() + ' ' + $cell.text().toUpperCase();
                };
                var sortDirection = $(this).is('.sorted-asc') ? -1 : 1;
                var $rows = $(".main-tablesort").find('tbody tr').get();
                var bob = 0;
                $.each($rows, function (index, row) {
                    row.sortKey = findSortKey($(row).children('td').eq(column));
                });
                var self = this;
                var $buttons = $('.sort');
                idx = $buttons.index(this);
                $rows.sort(function (a, b) {
                    var $obj1 = $(a).find('td').eq(idx),
                    $obj2 = $(b).find('td').eq(idx),
                    value1, value2;
                    count++;
                    if (a.sortKey == b.sortKey) {
                        no++;
                        return 0;
                    }
                    else {
                        if ($.isNumeric((a.sortKey)) == true) {
                            if (parseFloat(a.sortKey) < parseFloat(b.sortKey)) {
                                return -sortDirection;
                            }
                            if (parseFloat(a.sortKey) > parseFloat(b.sortKey)) {
                                return sortDirection;
                            }
                        }
                        else if ((a.sortKey).split(":").length - 1 == 1) {
                            var res = (a.sortKey).replace("PM", " PM").replace("AM", " AM");
                            var ser = (b.sortKey).replace("PM", " PM").replace("AM", " AM");
                            a = new Date('1970/01/01 ' + res);
                            b = new Date('1970/01/01 ' + ser);
                            return a < b ? -sortDirection : a > b ? sortDirection : 0;
                        }
                        else if ((a.sortKey).split(" ").length - 1 >= 90) {
                            value1 = $obj1.find("input")[0].checked;
                            value2 = $obj2.find("input")[0].checked;
                            return value1 < value2 ? -sortDirection : value1 > value2 ? sortDirection : 0;
                        }
                        else {
                            if (a.sortKey < b.sortKey) {
                                return -sortDirection;
                            }
                            if (a.sortKey > b.sortKey) {
                                return sortDirection;
                            }
                        }
                        return 0;
                    }
                });
                $.each($rows, function (index, row) {
                    if (count == no) {
                    }
                    else {
                        $('.main-tablesort tbody').append(row);
                        row.sortKey = null;
                    }
                });
                $('.main-tablesort th').removeClass('sorted-asc sorted-desc');
                $('.main-tablesort th i').removeClass('icon-white icon-chevron-down icon-white icon-chevron-up');
                var $sortHead = $('.main-tablesort th').filter('.main-tablesort :nth-child(' + (column + 1) + ')');
                var parents = $(this).prevAll().find('th img').context.childNodes[1].className;
                if (count != no) {
                    if (sortDirection == 1) {
                        $sortHead.addClass('sorted-asc');
                        $("." + parents).addClass('icon-white icon-chevron-up');
                        $("." + parents).css("margin-top", "-4px");
                    }
                    else {
                        $sortHead.addClass('sorted-desc');
                        $("." + parents).addClass('icon-white icon-chevron-down');
                        $("." + parents).css("margin-top", "-4px");
                    }
                }
                count = ""; no = "";
                $('.main-tablesort td').removeClass('sorted').filter('.main-tablesort :nth-child(' + (column + 1) + ')').addClass('sorted');
            });
        });
        doublesort();
        var mfgno = '@ViewBag.No';
        var company = window.parent.document.getElementById('company').value;

        self.txtmfgno(mfgno);
        self.txtcompany(company);

        function FillGrid() {
            $.ajax({
                url: "FillRoomlistgrid",
                data: { mfgno: mfgno, MeetId: MeetId },
                type: "POST",
                async: false,
                success: function (response) {

                    $("#tblroom tbody").empty();
                    $('#tblroom thead th').removeClass('sorted-asc sorted-desc');
                    $('#tblroom thead th i').removeClass('icon-white icon-chevron-down icon-white icon-chevron-up');

                    self.FillRoomlistgridd(response.Items);

                    if (response.rowindex > 0) {
                        $('#tblroom tbody tr:eq(' + response.rowindex + ')').addClass('success selected');
                        self.SelectedMfgroomlist(response.Items[response.rowindex]);
                        rowIndex = response.rowindex;
                    }
                    else if (response.rowindex < 0) {
                        $('#tblroom tbody tr:first').addClass('success selected');
                        self.SelectedMfgroomlist(response.Items[0]);
                        rowIndex = response.rowindex;
                    }
                    else {
                        $('#tblroom tbody tr:first').addClass('success selected');
                        self.SelectedMfgroomlist(response.Items[0]);
                        rowIndex = response.rowindex;
                    }
                    if (response.Items.length == 0) {
                        clearfields();
                      
                    }
                }
            });
        }
        function FillMeetingGrid() {
            $.ajax({
                url: "FillMeetinglistgrid",
                data: {
                    meetingcode: self.txtmtgno(), Date: self.txtarrive()
                },
                type: "POST",
                async: false,
                success: function (response) {
                    self.FillMeetinglistgrid(response.Items);
                    self.FillMeetinglistgrid2(response.Items2);

                    var mtgcode = response.MeetCode;
                    if (self.txtmtgno() != null && self.txtmtgno() != "")
                        $("#MeetingTitle").text("Meeting Code For : " + self.txtmtgno());
                    else
                        $("#MeetingTitle").text("Meeting Code For : " + mtgcode);
                }
            });
        }
        function FillMeetingGridwithcode(meetcode) {
            $.ajax({
                url: "FillMeetinglistgrid",
                data: {
                    meetingcode: self.txtmtgno(), Date: self.txtarrive()
                },
                type: "POST",
                async: false,
                success: function (response) {
                    self.FillMeetinglistgrid(response.Items);
                    self.FillMeetinglistgrid2(response.Items2);
                    if (self.txtmtgno() != null && self.txtmtgno() != "")
                        $("#MeetingTitle").text("Meeting Code For : " + self.txtmtgno());
                    else
                        $("#MeetingTitle").text("Meeting Code For : ");
                }
            });
        }
        $.ajax({
            url: "MfgContactList",
            data: { MfgNo: mfgno },
            type: "POST",
            success: function (response) {
                self.cmbcontactlist(response.Items);
                FillGrid();
                FillMeetingGrid();
            }
        });


        self.SelectedMfgroomlist = function (item) {
            if (self.SaveMode() == true) {
                return false;
            }
            if (item != undefined) {
                self.MeetingId(item.MeetingId);
                self.txtmtgno(item.MtgNo);
                mtgno = item.MtgNo;
                //self.txtcontactno(item.MfgContactNo);
                document.getElementById('cmbsharing').value = item.share;
                self.txtsharecode(item.share);
                self.txtsessno(item.sessionno.trim())
                self.txtroommate(item.roommate);
                self.txtarrive(DateBind(item.arrive));
                startdate = DateBind(item.arrive);
                self.txtnights(item.nights);
                self.txtdepart(DateBind(item.depart));
                //self.txtContactTitle(item.ContactTitle);

                self.txtroomtype(item.type.trim());
                self.txtroomno(item.roomno.trim());
                self.txtconfno(item.Confirmation);

                self.txtremarks(item.remarks);
                self.txtcode_1(item.LateCheckout);
                FillMeetingGridwithcode(item.MtgNo);
                if (screenname == "Manufacturer") {
                    self.txtcontactno(item.MfgContactNo);
                    FillContactInfo(mfgno, item.MfgContactNo);
                }
                else {
                    self.txtcontactno(item.MfgContactNo);
                    FillContactInfo(mfgno, item.MfgContactNo);
                }
            }
            else {
                self.AddMode(false);
                self.SaveMode(false);
                self.EditMode(true);
                self.EnableDisableMode(true);
            }


        }
        function fillsystemgrid() {
            $.ajax({
                url: "FillSystemDefaultsRoomlistinfo",
                type: "POST",
                async: false,
                success: function (response) {
                    self.txtmtgno(response.Items[0].meetingcode);

                    sysdate = DateBind(response.Items[0].Startdate);
                    self.txtarrive(sysdate);
                    self.txtdepart(DateBind(response.Items[0].depart));
                    self.txtnights(response.Items[0].nights);
                }
            });
        }

        function clearfields() {
            self.txtContactTitle("");
            self.txtContactEmail("");
            self.txtcontactno("");
            self.txtroommate("");
            self.txtsharecode("");
            self.txtroomtype("");
            self.txtroomno("");
            self.txtconfno("");
            self.txtsessno("");
            self.txtremarks("");
            self.txtcode_1("");
        }

        self.Add = function () {
            if (self.SaveMode() == true)
                return false;

            window.parent.CallDisableTabs();
            //self.txtContactTitle("");
            //self.txtContactEmail("");
            //self.txtcontactno("");
            //self.txtroommate("");
            //self.txtroomtype("");
            //self.txtroomno("");
            //self.txtconfno("");
            //self.txtsessno("");
            //self.txtremarks("");

            clearfields();
            self.txtcode_1("N");
            self.txtsharecode("N");

            self.AddMode(true);
            self.SaveMode(true);
            self.EditMode(false);
            self.EnableDisableMode(false);
            fillsystemgrid();
            $("#meetcode").focus();
            $('.clickableRow').removeClass('success selected');

        }
        self.Edit = function () {
            self.AddMode(false);
            self.SaveMode(true);
            self.EditMode(false);
            self.EnableDisableMode(false);

            window.parent.CallDisableTabs();

            $("#meetcode").focus();
        }
        self.Save = function () {

            if (self.txtmtgno() == null || self.txtmtgno() == "") {
                $.msgBox({
                    title: "Gro Group",
                    content: "Please enter Meeting Code",
                    type: "info",
                    buttons: [{ value: "Ok" }],
                    afterClose: function (result) {
                        document.getElementById('meetcode').focus();
                    }
                });
                return false;
            }
            if (self.txtcontactno() == null || self.txtcontactno() == "") {
                $.msgBox({
                    title: "Gro Group",
                    content: "Please select Contact",
                    type: "info",
                    buttons: [{ value: "Ok" }],
                    afterClose: function (result) {
                        document.getElementById('cmbcontact').focus();
                    }
                });
                return false;
            }
            //if (self.txtarrive() == null || self.txtarrive() == "") {
            //    $.msgBox({
            //        title: "Gro Group",
            //        content: "Please enter Arrive Date",
            //        type: "info",
            //        buttons: [{ value: "Ok" }],
            //        afterClose: function (result) {
            //            document.getElementById('Arrive').focus();
            //        }
            //    });
            //    return false;
            //}
            //if (self.txtdepart() == null || self.txtdepart() == "") {
            //    $.msgBox({
            //        title: "Gro Group",
            //        content: "Please enter Depart Date",
            //        type: "info",
            //        buttons: [{ value: "Ok" }],
            //        afterClose: function (result) {
            //            document.getElementById('Depart').focus();
            //        }
            //    });
            //    return false;
            //}
         
            if (self.txtarrive() != null && self.txtarrive() != "") {
                var isarrivedatvalidate = isValidDate(self.txtarrive());
                if (isarrivedatvalidate == false) {
                    $.msgBox({
                        title: "Gro Group",
                        content: "Please enter the valid Arrive Date",
                        type: "info",
                        buttons: [{ value: "Ok" }],
                        afterClose: function (result) {
                            document.getElementById('Arrive').focus();
                        }
                    });
                    return false;
                }
            }

            if (self.txtdepart() != null && self.txtdepart() != "") {
                var isdeptdatvalidate = isValidDate(self.txtdepart());
                if (isdeptdatvalidate == false) {
                    $.msgBox({
                        title: "Gro Group",
                        content: "Please enter the valid Depart Date",
                        type: "info",
                        buttons: [{ value: "Ok" }],
                        afterClose: function (result) {
                            document.getElementById('Depart').focus();
                        }
                    });
                    return false;
                }
            }

            if (self.txtarrive() == null || self.txtarrive() == "") {
                if (self.txtdepart() != null && self.txtdepart() != "") {
                    self.txtdepart("");
                        //$.msgBox({
                        //    title: "Gro Group",
                        //    content: "Arrive Date is empty,so Depart Date should be empty.",
                        //    type: "info",
                        //    buttons: [{ value: "Ok" }],
                        //    afterClose: function (result) {
                        //        document.getElementById('Depart').focus();
                        //    }
                        //});
                        //return false;
                }
            }

            if (self.txtarrive() != "" && self.txtdepart()!="") {
                if (self.txtdepart() <= self.txtarrive()) {
                    $.msgBox({
                        title: "Gro Group",
                        content: "Depart Date is greater then Arrive Date",
                        type: "info",
                        buttons: [{ value: "Ok" }],
                        afterClose: function (result) {
                            document.getElementById('Depart').focus();
                        }
                    });
                    return false;
                }
            }
           
           

            saveroom();

        }
        function saveroom() {
            objroom = [];

            objroom = {
                MeetingId: self.MeetingId(),
                meetcode: self.txtmtgno(),
                MtgNo: self.txtmtgno(),
                mfgno: self.txtmfgno(),
                company: self.txtcompany(),
                contactno: self.txtcontactno(),
                roommate: self.txtroommate(),
                sharing: self.txtsharecode(),
                arrive: self.txtarrive(),
                nights: self.txtnights(),
                depart: self.txtdepart(),
                typeroom: self.txtroomtype(),
                //ContactTitle:self.txtContactTitle(),

                roomno: self.txtroomno(),
                confno: self.txtconfno(),
                sessno: self.txtsessno(),
                remarks: self.txtremarks(),
                latecheck: self.txtcode_1()
            }

            $.ajax({
                url: "saveroomlist",
                data: { ObjroomList: JSON.stringify(objroom), MeetingId: self.MeetingId(), MtgNo: self.txtmtgno(), IsAddMode: self.AddMode() },
                type: "POST",
                success: function (response) {

                    self.AddMode(false);
                    self.EditMode(true);
                    self.SaveMode(false);
                    self.EnableDisableMode(true);
                    if (response.ItemMsg != undefined && response.ItemMsg != null && response.ItemMsg != "") {
                        alert("Gro Group", response.Items);
                    }
                    else {
                        if (response.Items != "") {
                            MeetId = response.Items;
                            FillGrid();
                        }
                    }
                    var THIndex = $('#tblroom thead th').length;
                    for (var i = 0; i < THIndex; i++) {
                        if ($('#tblroom thead th')[i].className == "hide")
                            $('td').filter(':nth-child(' + (i + 1) + ')').addClass('hide');
                    }
                }
            });

            window.parent.CallEnableTabs();

            FillMeetingGrid();
        }
        self.Cancel = function () {
            if (self.SaveMode() != true)
                return false;
            window.parent.CallEnableTabs();
            if (self.FillRoomlistgridd().length == 0) {
                self.AddMode(false);
                self.EditMode(true);
                self.SaveMode(false);
                self.EnableDisableMode(true);

                /* to clear records */
                self.txtcontactno("");
                self.txtroommate("");
                self.txtsharecode("");
                self.txtroomtype("");
                self.txtroomno("");
                self.txtconfno("");
                self.txtsessno("");
                self.txtremarks("");
                self.txtcode_1("");
            }
            else {
                alertconfirm("Are You Sure", "Do you want to cancel current changes ?", self.confirmcancel, false, false);
            }
        }
        self.confirmcancel = function () {
            self.AddMode(false);
            self.EditMode(true);
            self.SaveMode(false);
            self.EnableDisableMode(true);
            self.SelectedMfgroomlist(self.FillRoomlistgridd()[rowIndex]);
            $("#" + rowIndex).addClass('success selected');
        }
        self.Delete = function () {
            if (self.SaveMode() == true)
                return false;

            alertconfirm("Are You Sure", "Do you want to delete this record ?", self.confirmdelete, false, false);
            //alerterror("Denied", "Record cannot be deleted");
        }
        self.confirmdelete = function () {
            $.ajax({
                url: "DeleteRoomlist",
                data: { meetcode: self.MeetingId() },
                type: "POST",
                success: function (response) {
                    FillGrid();
                    FillMeetingGrid();
                }
            });


        }

        self.arrivedatechange = function () {
            var fdate = new Date(sysdate);

            if (self.txtarrive() != null && self.txtarrive() != "") {
                var todate = new Date(self.txtarrive());

                var timeDiff = todate.getTime() - fdate.getTime();
                var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));
                if (diffDays > 6 || diffDays < 0) {
                    $.msgBox({
                        title: "Gro Group",
                        content: "Arrive Date is with in a system date of week",
                        type: "info",
                        buttons: [{ value: "Ok" }],
                        afterClose: function (result) {
                            self.txtarrive(sysdate);

                        }
                    });
                }
                else {
                    self.Calculatenight();
                }
            }
            else {
                self.txtnights("");
            }

        }

        self.Calculatenight = function () {
            var fdate = new Date(self.txtarrive());
            var todate = new Date(self.txtdepart());

            if ((fdate != null || fdate != "")&&(fdate != "Invalid Date")) {
                if (self.txtdepart() != null && self.txtdepart() != "") {
                    if (todate <= fdate) {
                        $.msgBox({
                            title: "Gro Group",
                            content: "Depart Date is greater then Arrive Date",
                            type: "info",
                            buttons: [{ value: "Ok" }],
                            afterClose: function (result) {
                                document.getElementById('Depart').focus();
                            }
                        });
                        return false;
                    }
                    var timeDiff = Math.abs(todate.getTime() - fdate.getTime());
                    var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));

                    if (diffDays > 7) {
                        $.msgBox({
                            title: "Gro Group",
                            content: "Depart Date is with in a Arrive Date of Week",
                            type: "info",
                            buttons: [{ value: "Ok" }],
                            afterClose: function (result) {

                            }
                        });

                    }

                    self.txtnights(diffDays);
                }
                else {
                    self.txtnights("0");
                }
            }
            else
            {
                self.txtnights("");
            }

            
        }

        self.contactchange = function () {
            if (mfgno != null && mfgno != "" && self.txtcontactno() != null && self.txtcontactno() != "") {
                FillContactInfo(mfgno, self.txtcontactno());
            }
            else {
                self.txtContactTitle("");
                self.txtContactEmail("");
            }
        }

        function FillContactInfo(no, contno) {
            $.ajax({
                url: "GetRoomlistContactInfo",
                type: "POST",
                data: { mfgNo: mfgno, contactNo: contno },
                success: function (response) {
                    if (response.Items != null && response.Items != "" && response.Items.length > 0) {
                        self.txtContactTitle(response.Items[0].ntitle);
                        self.txtContactEmail(response.Items[0].nemail);
                    }
                    else {
                        self.txtContactTitle("");
                        self.txtContactEmail("");
                    }
                }
            });
        }

        self.summarycombochange = function () {
            var sessionno = self.txtsession().trim();
            var type = self.txttype().trim();
            var sessno, companytype;
            if (sessionno != null && sessionno != "")
                sessno = sessionno;
            else 
                sessno = "";

            if (type != null && type != "")
                companytype = type;
            else
                companytype = "";
          
            meetinglistgrid(sessno, companytype);
        }
        function meetinglistgrid(sessno, companytype) {
            $.ajax({
                url: "FillMeetinglistgridwithsession",
                data: {
                    meetingcode: self.txtmtgno(), Date: self.txtarrive(), Sessionno: sessno, Type: companytype
                },
                type: "POST",
                async: false,
                success: function (response) {
                    self.FillMeetinglistgrid("");
                    self.FillMeetinglistgrid2("");

                    $("#tblsummary1 tbody").empty();
                    $('#tblsummary1 thead th').removeClass('sorted-asc sorted-desc');
                    $('#tblsummary1 thead th i').removeClass('icon-white icon-chevron-down icon-white icon-chevron-up');
                    $('#tblsummary1 thead th').removeClass('hide');

                    self.FillMeetinglistgrid(response.Items);
                    self.FillMeetinglistgrid2(response.Items2);
                }
            });
        }

        self.Showreport = function () {
            $.ajax({
                url: "FillReport",
                type: "POST",
                data: { Repname: "RP_NightSummary.repx" },
                async: false,
                success: function (response) {
                    //window.parent.parent.document.getElementById('searchscreen').src = "../GroGroup/FormReport";
                    //fireEvent(window.parent.parent.document.getElementById('sc1'), 'click');

                    window.parent.parent.document.getElementById('reportscreen').src = "../GroGroup/FormReport";
                    fireEvent(window.parent.parent.document.getElementById('openreport'), 'click');
                }
            });
        }

        $('.tablinks').live('click', function (evt) {
            menuName = evt.currentTarget.innerHTML;
            if (self.EditMode()==false) {
                if (menuName != submenuname) {
                    content = "Leave " + submenuname + " page?";
                    $.msgBox({
                        title: "Gro Group",
                        content: content,
                        type: "info",
                        buttons: [{ value: "Yes" }, { value: "No" }],
                        success: function (result) {
                            if (result == "Yes") {
                                self.confirmcancel();
                                opentab();
                            }
                        }
                    });
                }
                else
                    return false;
            }
            else {
                opentab();
            }

        });

        function opentab() {
            // Declare all variables
            var i, tabcontent, tablinks;
            submenuname = menuName;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }

            // Get all elements with class="tablinks" and remove the class "active"
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
                if (tablinks[i].innerText == menuName) {
                    tablinks[i].className = "tablinks active";
                    $("#NotesDialog").dialog("close");
                }
            }

            // Show the current tab, and add an "active" class to the link that opened the tab
            document.getElementById(menuName).style.display = "block";
           // evt.currentTarget.className += " active";
            //if (menuName == "Roomlist") {
            //}
            //else if (menuName == "MeetingCode") {
            //    tablinks[1].className = "tablinks";
            //    $("#NotesDialog").dialog("close");
            //}
        }
    }


   
    function fnExcelReport() {
        $.ajax({
            url: "exportsummarytable",
            data: { meetingcode: mtgno, Date: startdate },
            type: "POST",
            async: false,
            success: function (response) {
                document.getElementById('hylnproceed').click();
                $("#NotesDialog").dialog("close");
            }
        });
    }



    function fnExcelReport2() {
        $("#MainNotesDialog").dialog("close");
        var table = document.getElementById("tblroom");
        GlobalExcelExportsortable(table, "Room list", "RoomList_.csv", "Screen", "TblRoom_");
    }




</script>
<div class="tab tabon">
    <button class="tablinks">Room List</button>
    <button class="tablinks">Summary</button>
</div>

<div id="Room List" class="tabcontent" style="height:700px !important;">
    <div class="tab-roomlist">
        <div class="row-fluid">
            <div class="span4">
                <ul class="list-nostyle list-inline tooltipsample">
                    <li><a data-placement="bottom" data-rel="tooltip" data-original-title="Add" title="Add" class="btn btn-primary" id="btnAdd"><i class="icon-file icon-white"></i></a></li>
                    <li data-bind="visible: EditMode"><a data-placement="bottom" data-rel="tooltip" data-original-title="Edit" title="Edit" class="btn btn-warning" id="btnEdit"><i class="icon-edit icon-white"></i></a></li>
                    <li data-bind="visible: SaveMode"><a data-placement="bottom" data-rel="tooltip" data-original-title="Save" title="Save" class="btn btn-warning" id="btnSave"><i class="icon-list-alt icon-white"></i></a></li>
                    <li><a data-placement="bottom" data-rel="tooltip" data-original-title="Delete" title="Delete" class="btn btn-danger" id="btnDelete"><i class="icon-remove icon-white"></i></a></li>
                    <li><a data-placement="bottom" data-rel="tooltip" data-original-title="Cancel" title="Cancel" class="btn btn-info" id="btnCancel"><i class="iconsweets-arrowleft iconsweets-white"></i></a></li>
                </ul>
            </div>

        </div>
        <div class="widgetbox1">
            <h4 class="widgettitle" id="Title"> </h4>
            <div class="widgetcontent">
                <div class="widgetcontent" style="border: 1px #BCD8F3 solid; margin-top: 5px">
                    <div class="row-fluid">

                        <div class="span6">
                            <label class="span3 mob-span">Meeting Code</label>
                            <input id="meetcode" maxlength="20" type="text" class="input-medium mob-text" data-bind="disable: EnableDisableMode,value:txtmtgno" required />
                        </div>
                        <div class="span6">
                            <label class="span4 mob-span">Room Type</label>
                            <select id="cmbroomtype" class="select input-medium mob-cmb" style="width:160px;" data-bind="disable:EnableDisableMode, options:cmbroomtypelist,optionsText:'descript',optionsValue:'entry',value:txtroomtype"></select>
                        </div>
                    </div>
                    <div class="row-fluid">

                        <div class="span6">
                            <label class="span3 mob-span">Session</label>
                            <select id="cmbsessno" maxlength="1" class="select input-small mob-cmb" style="width:160px;" data-bind="disable:EnableDisableMode, options:cmbsessnolist,optionsText:'descript',optionsValue:'entry',value:txtsessno"></select>
                        </div>
                        <div class="span6">
                            <label class="span4 mob-span">Sharing</label>
                            <select id="cmbsharing" maxlength="1" class="select input-medium mob-cmb" style="width:160px;" data-bind="disable:EnableDisableMode, options:cmbsharinglist,optionsText:'descript',optionsValue:'entry',value:txtsharecode"></select>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span6">
                            <label class="span3 mob-span">Contact Name</label>
                            <select id="cmbcontact" maxlength="4" class="select input-medium mob-cmb" style="width:160px;" data-bind="disable:EnableDisableMode, options:cmbcontactlist,optionsText:'contactname',optionsValue:'contactno',value:txtcontactno" required></select>
                        </div>
                        <div class="span6">
                            <label class="span4 mob-span">Roommate</label>
                            <input id="txtroommate" maxlength="50" type="text" class="input-medium mob-text" style="width: 275px;" data-bind="disable: EnableDisableMode, value: txtroommate" />
                        </div>
                    </div>

                    <div class="row-fluid">
                        
                        <div class="span6">
                            <label class="span3 mob-span">Contact Title</label>
                            <input id="textconttitle" class="input-xlarge mob-text" type="text" readonly="readonly"  data-bind="disable: EnableDisableMode, value: txtContactTitle"/>
                        </div>
                        <div class="span6">
                            <label class="span4 mob-span">Room No.</label>
                            <input id="RoomNo" maxlength="4" type="text" class="input-medium mob-text" data-bind="disable: EnableDisableMode, value: txtroomno"/>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span6">
                            <label class="span3 mob-span">Contact Email</label>
                            <input id="textcontemail"  class="input-xlarge mob-text"  type="text" readonly="readonly" data-bind="disable: EnableDisableMode, value: txtContactEmail"/>
                        </div>
                        <div class="span6">
                            <label class="span4 mob-span">Late Checkout</label>
                            <select id="cmblatecheckout" maxlength="2" class="select input-medium mob-cmb" style="width:160px;" data-bind="disable:EnableDisableMode, options:cmbcheckoutlist,optionsText:'descript',optionsValue:'entry',value:txtcode_1"></select>
                        </div>
                        </div>
                        <div class="row-fluid">
                           
                            <div class="span6">
                                <label class="span3 mob-span">Arrive Date</label>
                                <input id="Arrive" maxlength="10" type="text" class="input-small mob-text" data-bind="disable: EnableDisableMode, value: txtarrive" />
                            </div>
                            <div class="span6">
                                <label class="span4 mob-span">Hotel Confirmation No.</label>
                                <input id="conformno" maxlength="10" type="text" class="input-medium mob-text" data-bind="disable: EnableDisableMode, value: txtconfno" />
                            </div>
                        </div>
                        <div class="row-fluid">
                           
                            <div class="span6">
                                <label class="span3 mob-span">Depart Date</label>
                                <input id="Depart" maxlength="10" type="text" class="input-small mob-text" data-bind="disable: EnableDisableMode, value: txtdepart" />
                            </div>
                            
                        </div>
                    <div class="row-fluid">
                        <div class="span6">
                <label class="span3 mob-span">No. of Nights</label>
                <input id="Nights" maxlength="2" type="text" readonly="readonly" class="input-small mob-text" data-bind="disable: EnableDisableMode, value: txtnights" />
                          </div>
                        </div>
                        <div class="row-fluid">
                            <div class="span12">
                                <label class="span2 mob-span" style="width:11.1%;">Comments</label>
                                <textarea id="Remarks" class="textarea-roomlist" maxlength="800" style="resize:none; width:80%;" data-bind="disable: EnableDisableMode,value: txtremarks"></textarea>
                            </div>
                        </div>
                        <input id="MeetingId" maxlength="20" type="hidden" class="input-medium" data-bind="disable: EnableDisableMode,value:MeetingId" />
                    </div>
                <div style="width: 100%;margin-top: 2%;">
                    <table id="tblroom" class="dytableroom table table-bordered table-hover main-tablesort" style="width: 99%;overflow-y: auto; overflow-x: auto;">
                        <thead style="width:100%;">
                            <tr class="main-exportclass">
                                <th>Meeting Code<i class="micon1" style="float: right; margin-top: -4px;"></i></th>
                                <th>Session<i class="micon2" style="float: right; margin-top: -4px;"></i></th>
                                @*<th>Contact Name<i class="micon2" style="float: right; margin-top: -4px;"></i></th>*@
                                <th>First Name<i class="micon3" style="float: right; margin-top: -4px;"></i></th>
                                <th>Last Name<i class="micon4" style="float: right; margin-top: -4px;"></i></th>
                                <th style="width:180px;">Email<i class="micon2" style="float: right; margin-top: -4px;"></i></th>
                                <th>Arrive Date<i class="micon5" style="float: right; margin-top: -4px;"></i></th>
                                <th>Depart Date<i class="micon6" style="float: right; margin-top: -4px;"></i></th>
                                <th>No.of Nights<i class="micon7" style="float: right; margin-top: -4px;"></i></th>
                                <th>Room Type<i class="micon8" style="float: right; margin-top: -4px;"></i></th>
                                <th>Roommate<i class="micon9" style="float: right; margin-top: -4px;"></i></th>
                                <th>Room No.<i class="micon10" style="float: right; margin-top: -4px;"></i></th>
                            </tr>
                        </thead>
                        <tbody style="max-height: 250px" data-bind="foreach: $root.FillRoomlistgridd">
                            <tr style="cursor:pointer;" class="clickableRow" data-bind="attr: {id: $index()}, click:$root.SelectedMfgroomlist">
                                <td data-bind="text: MtgNo"></td>
                                <td data-bind="text: sessionno"></td>
                                @*<td data-bind="text: ContactName"></td>*@
                                <td data-bind="text: FirstName"></td>
                                <td data-bind="text: LastName"></td>
                                <td style="width:180px;" data-bind="text: Email"></td>
                                <td data-bind="text: DateBind(arrive)"></td>
                                <td data-bind="text: DateBind(depart)"></td>
                                <td data-bind="text: nights"></td>
                                <td data-bind="text: type"></td>
                                <td data-bind="text: roommate"></td>
                                <td data-bind="text: roomno"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>


            </div>
        </div>
    </div>

    <div id="MainNotesDialog" title="Fields">
        <ul id="navigation" class="subs" data-bind="foreach:{ data: $root.mainmenulist }" style="margin-top:-4px;">
            <li style="list-style-type: none;">
                <a href="#" style="width:190px;text-decoration: none;">
                    <input type="checkbox" class="main-checked" data-bind="attr:{id:'mchk_'+ $index()}" />
                    <label data-bind="text:$data,attr:{id:'lbl_'+ $index(),for:'mchk_'+ $index()}"> </label>
                </a>
            </li>
        </ul>
    </div>
</div>
<div id="Summary" class="tabcontent" style="display:none;height:800px !important;">
    <h4 class="widgettitle" id="MeetingTitle"> </h4>
    <div class="widgetcontent">
        <div class="row-fluid" style="margin-top:1%;">
            <div class="span3">
                <label class="span4">Session No</label>
                <select id="cmbsession" maxlength="2" class="select input-medium" data-bind="options:cmbsessionlist,optionsText:'descript',optionsValue:'entry',value:txtsession"></select>
            </div>
            <div class="span3">
                <label class="span3">Type</label>
                <select id="cmbtype" maxlength="2" class="select input-medium" data-bind="options:cmbtypelist,optionsText:'CompanyType',optionsValue:'CompanyType',value:txttype">
                    @*/*@
                    @*<option value=""></option>
                    <option value="M">M</option>
                    <option value="D">D</option>*@
                </select>
            </div>
            <div class="span1" style="margin-left: 0px;">
                <a href="#"><img style="width:30px; height:30px;vertical-align:bottom" src="@Url.Content("~/images/report.png")" data-bind="click: $root.Showreport" title="Night Summary" /></a>
            </div>
            <a id="hylnproceed" href="../GroGroup/GetFileFromDisk" style="width:100px; display:none; height:25px; font-family:Verdana; font-size:12px; font-style:normal; font-weight:bold; color:Blue; background-color:InfoBackground;">Open or Save</a>

        </div>
        <div style="width: 100%;margin-top: 5px;">
            <table id="tblsummary1" class="dytable table table-bordered table-hover tablesort" style="width:99%;border: 1px solid #dddddd;overflow-y: auto; overflow-x: auto;">
                <thead style="width:100%;">
                    <tr class="exportclass">
                        <th style="width: 40px;">Type <i class="icon1" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width: 130px;">Company <i class="icon2" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width: 75px;">First Name <i class="icon3" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width: 75px;">Last Name <i class="icon4" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width: 130px;">Title<i class="icon5" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width: 150px;">Email<i class="icon5" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width: 75px;">Roommate <i class="icon6" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width: 45px;">Room Type <i class="icon7" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width: 35px;">Room No <i class="icon8" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width: 60px;">Arrive Date <i class="icon9" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width: 60px;">Depart Date<i class="icon10" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width:40px;">No.of Nights <i class="icon11" style="float: right; margin-top: -4px;"></i></th>
                        <th style="width:32px;">Sesssion <i class="icon12" style="float: right; margin-top: -4px;"></i></th>
                        @*<th style="width:70px;">Conf.# <i class="icon13" style="float: right; margin-top: -4px;"></i></th>*@
                    </tr>
                </thead>
                <tbody style="max-height:400px;width:100%;overflow-y: overlay;" data-bind="foreach: $root.FillMeetinglistgrid">
                    <tr style="cursor:pointer;">
                        <td style="width: 40px;" data-bind="text: CompanyType"></td>
                        <td style="width: 130px;" data-bind="text: company"></td>
                        @*<td style="width: 95px;" data-bind="text: ContactName"></td>*@
                        <td style="width: 75px;" data-bind="text: FirstName"></td>
                        <td style="width: 75px;" data-bind="text: LastName"></td>
                        <td style="width: 130px;" data-bind="text: Title"></td>
                        <td style="width: 150px;" data-bind="text: Email"></td>
                        <td style="width: 75px;" data-bind="text: roommate"></td>
                        <td style="width: 45px;" data-bind="text: type"></td>
                        <td style="width: 35px;" data-bind="text: roomno"></td>
                        <td style="width: 60px;" data-bind="text: DateBind(arrive)"></td>
                        <td style="width: 60px;" data-bind="text: DateBind(depart)"></td>
                        <td style="width:40px;" data-bind="text: nights"></td>
                        <td style="width:32px;" data-bind="text: sessionno"></td>
                        @*<td style="width:70px;" data-bind="text: Confirmation"></td>*@

                    </tr>
                </tbody>
            </table>
        </div>
        <div style="width: 100%;margin-top: 2%;">
            <table id="tblsummary2" class="dytable dytable1 table table-bordered table-hover" style="width: 99%;border: 1px solid #dddddd;overflow-x: auto;overflow-y: auto;">
                <thead style="width:100%;">
                    <tr>
                        <th>Total</th>
                        <th>Day1</th>
                        <th>Day2</th>
                        <th>Day3</th>
                        <th>Day4</th>
                        <th>Day5</th>
                        <th>Day6</th>
                        <th>Day7</th>
                    </tr>
                </thead>
                <tbody style="max-height: 200px;overflow: overlay;" data-bind="foreach: $root.FillMeetinglistgrid2">
                    <tr style="cursor:pointer;">
                        <td data-bind="text: company"></td>
                        <td data-bind="text: day1"></td>
                        <td data-bind="text: day2"></td>
                        <td data-bind="text: day3"></td>
                        <td data-bind="text: day4"></td>
                        <td data-bind="text: day5"></td>
                        <td data-bind="text: day6"></td>
                        <td data-bind="text: day7"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
